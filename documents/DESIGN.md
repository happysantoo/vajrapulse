# VajraPulse Test Framework - Design Documentation

## Executive Summary

VajraPulse is a distributed load testing framework designed for high-scale performance testing with flexible deployment models. Built on **Java 21**, it leverages **virtual threads** for massive concurrency with minimal resource overhead, while also supporting platform threads for CPU-intensive workloads. The framework supports both orchestrated and peer-to-peer distributed testing modes with comprehensive metrics collection and reporting.

### Technology Stack
- **Language**: Java 21
- **Concurrency**: Virtual Threads (Project Loom) for I/O-bound tasks, Platform Threads for CPU-bound tasks
- **Build**: Maven/Gradle
- **Observability**: OpenTelemetry, Micrometer
- **Communication**: gRPC, HTTP/REST

---

## Table of Contents

1. [System Overview](#system-overview)
2. [Core Components](#core-components)
3. [Architecture Designs](#architecture-designs)
4. [Design Alternatives](#design-alternatives)
5. [Extensibility Points](#extensibility-points)
6. [Component Details](#component-details)
7. [Deployment Scenarios](#deployment-scenarios)

---

## System Overview

### High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VAJRA TEST FRAMEWORK                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Orchestrator     â”‚              â”‚    Test Workers          â”‚  â”‚
â”‚  â”‚   (Optional)       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    (Core Engine)         â”‚  â”‚
â”‚  â”‚                    â”‚              â”‚                          â”‚  â”‚
â”‚  â”‚  â€¢ Load Manager    â”‚              â”‚  â€¢ Task SDK              â”‚  â”‚
â”‚  â”‚  â€¢ Distribution    â”‚              â”‚  â€¢ Execution Engine      â”‚  â”‚
â”‚  â”‚  â€¢ UI Dashboard    â”‚              â”‚  â€¢ Metrics Processor     â”‚  â”‚
â”‚  â”‚  â€¢ Coordination    â”‚              â”‚  â€¢ P2P Coordination      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                       â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                      â”‚  Metrics & Reporting  â”‚                       â”‚
â”‚                      â”‚                       â”‚                       â”‚
â”‚                      â”‚  â€¢ OpenTelemetry     â”‚                       â”‚
â”‚                      â”‚  â€¢ BlazeMeter        â”‚                       â”‚
â”‚                      â”‚  â€¢ Console           â”‚                       â”‚
â”‚                      â”‚  â€¢ Grafana           â”‚                       â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Core Components

### 1. Task SDK (Worker Library)

The foundation of test execution - a lean, extensible interface for defining test scenarios.

```java
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Task Interface                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  public interface Task {                             â”‚   â”‚
â”‚  â”‚    void setup() throws Exception;                    â”‚   â”‚
â”‚  â”‚    TaskResult execute() throws Exception;            â”‚   â”‚
â”‚  â”‚    void cleanup() throws Exception;                  â”‚   â”‚
â”‚  â”‚  }                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  public sealed interface TaskResult {                â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚    record Success(Object data) implements TaskResult;â”‚   â”‚
â”‚  â”‚    record Failure(Throwable error)                   â”‚   â”‚
â”‚  â”‚                    implements TaskResult;            â”‚   â”‚
â”‚  â”‚                                                       â”‚   â”‚
â”‚  â”‚    // Helper factory methods                         â”‚   â”‚
â”‚  â”‚    static TaskResult success() { ... }               â”‚   â”‚
â”‚  â”‚    static TaskResult success(Object data) { ... }    â”‚   â”‚
â”‚  â”‚    static TaskResult failure(Throwable e) { ... }    â”‚   â”‚
â”‚  â”‚  }                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  NOTE: Latency, timestamp, and metrics are captured by       â”‚
â”‚        TaskExecutor - NOT part of TaskResult!                â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Design Principles:**
- **Simplicity**: Only 3 essential methods, minimal TaskResult
- **Separation of Concerns**: Task focuses on business logic; executor handles metrics
- **Java 21 Features**: Sealed interfaces, records for immutability
- **Flexibility**: Task writers control test data generation completely
- **Lifecycle Management**: Clear setup/teardown hooks

### 2. Test Worker Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TEST WORKER (Java 21)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Configuration Manager                          â”‚ â”‚
â”‚  â”‚  â€¢ CLI Args Parser  â€¢ Config Files  â€¢ Env Variables        â”‚ â”‚
â”‚  â”‚  â€¢ Java Properties  â€¢ YAML/HOCON Support                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Execution Engine                               â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚  Rate        â”‚  â”‚  Scheduler   â”‚  â”‚  Thread      â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  Controller  â”‚  â”‚              â”‚  â”‚  Strategy    â”‚    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚  â€¢ Ramp-up   â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Target    â”‚  â”‚  â€¢ Steady    â”‚  â”‚  â€¢ VIRTUAL   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚    TPS       â”‚  â”‚  â€¢ Ramp-down â”‚  â”‚    (I/O)     â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Duration  â”‚  â”‚  â€¢ Warmup    â”‚  â”‚  â€¢ PLATFORM  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Pacing    â”‚  â”‚              â”‚  â”‚    (CPU)     â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Virtual Thread Pool (I/O-bound tasks):                    â”‚ â”‚
â”‚  â”‚    Executors.newVirtualThreadPerTaskExecutor()             â”‚ â”‚
â”‚  â”‚    â€¢ Millions of lightweight threads                        â”‚ â”‚
â”‚  â”‚    â€¢ Minimal memory footprint                               â”‚ â”‚
â”‚  â”‚    â€¢ Perfect for HTTP, DB, messaging workloads             â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Platform Thread Pool (CPU-bound tasks):                   â”‚ â”‚
â”‚  â”‚    ForkJoinPool.commonPool() or custom ThreadPoolExecutor  â”‚ â”‚
â”‚  â”‚    â€¢ Fixed size = Runtime.availableProcessors()            â”‚ â”‚
â”‚  â”‚    â€¢ For compute-intensive operations                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Task Executor (Instrumented)                   â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Wraps task execution with automatic instrumentation:      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  start = System.nanoTime()                                  â”‚ â”‚
â”‚  â”‚  try {                                                       â”‚ â”‚
â”‚  â”‚    result = task.execute()  â—„â”€â”€ User's Task (Pure Logic)   â”‚ â”‚
â”‚  â”‚    recordSuccess(result, duration)                          â”‚ â”‚
â”‚  â”‚  } catch (Exception e) {                                    â”‚ â”‚
â”‚  â”‚    recordFailure(e, duration)                               â”‚ â”‚
â”‚  â”‚  }                                                           â”‚ â”‚
â”‚  â”‚  duration = System.nanoTime() - start                       â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Task Writer Controls:                                      â”‚ â”‚
â”‚  â”‚  â€¢ Test data generation (no framework interference)         â”‚ â”‚
â”‚  â”‚  â€¢ Request construction                                     â”‚ â”‚
â”‚  â”‚  â€¢ Custom validation logic                                  â”‚ â”‚
â”‚  â”‚  â€¢ State management                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           Metrics Processor & Aggregator                    â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚  Collector   â”‚  â”‚  Aggregator  â”‚  â”‚  Reservoir   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  (Micrometer)â”‚  â”‚  (HdrHisto)  â”‚  â”‚  (Sampling)  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Results   â”‚  â”‚  â€¢ Count     â”‚  â”‚  â€¢ Histogram â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Latency   â”‚  â”‚  â€¢ Min/Max   â”‚  â”‚  â€¢ P50/P95   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Success   â”‚  â”‚  â€¢ Mean      â”‚  â”‚  â€¢ P99/P999  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Errors    â”‚  â”‚  â€¢ StdDev    â”‚  â”‚  â€¢ T-Digest  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Timestamp â”‚  â”‚              â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Metrics Exporters                              â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚ OpenTelemetryâ”‚  â”‚ BlazeMeter   â”‚  â”‚  Console     â”‚    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ OTLP      â”‚  â”‚  â€¢ HTTP API  â”‚  â”‚  â€¢ Stdout    â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Traces    â”‚  â”‚  â€¢ Cloud     â”‚  â”‚  â€¢ Summary   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Metrics   â”‚  â”‚  â€¢ Sessions  â”‚  â”‚  â€¢ Real-time â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚         Custom Exporter Plugin Interface            â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚          Coordination Layer (Optional)                      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚ Orchestrator â”‚  â”‚  P2P Mode    â”‚  â”‚  Standalone  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚   Client     â”‚  â”‚              â”‚  â”‚    Mode      â”‚    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚  â€¢ Discovery â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ RPC/gRPC  â”‚  â”‚  â€¢ Gossip    â”‚  â”‚  â€¢ No Coord  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Commands  â”‚  â”‚  â€¢ Election  â”‚  â”‚  â€¢ Local     â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Orchestrator Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     TEST ORCHESTRATOR                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   Web UI / API Gateway                      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚   Test       â”‚  â”‚   Worker     â”‚  â”‚   Results    â”‚    â”‚ â”‚
â”‚  â”‚  â”‚   Config     â”‚  â”‚   Manager    â”‚  â”‚   Viewer     â”‚    â”‚ â”‚
â”‚  â”‚  â”‚   Form       â”‚  â”‚   Dashboard  â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Load Distribution Engine                       â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  Load Calculator                                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Total TPS: 10,000                                 â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Available Workers: 5                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Per-Worker TPS: 10,000 / 5 = 2,000               â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Distribution Strategy:                            â”‚   â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ Equal Split (default)                          â”‚   â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ Weighted (by worker capacity)                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚   â€¢ Custom (user-defined)                          â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Worker Registry & Discovery                    â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚  Registry    â”‚  â”‚  Health      â”‚  â”‚  Capacity    â”‚    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚  Checker     â”‚  â”‚  Monitor     â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Workers   â”‚  â”‚              â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Status    â”‚  â”‚  â€¢ Heartbeat â”‚  â”‚  â€¢ CPU/Mem   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Metadata  â”‚  â”‚  â€¢ Liveness  â”‚  â”‚  â€¢ Network   â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           Test Execution Coordinator                        â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  State Machine                                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  CREATED â†’ DISTRIBUTING â†’ RUNNING â†’ STOPPING       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚             â†’ COMPLETED / FAILED                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Synchronize Start/Stop                          â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Handle Worker Failures                          â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Redistribute Load on Worker Loss                â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           Communication Layer (gRPC/REST)                   â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚     Orchestrator â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Workers       â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Commands:                      Responses:                  â”‚ â”‚
â”‚  â”‚  â€¢ START_TEST                   â€¢ ACK                       â”‚ â”‚
â”‚  â”‚  â€¢ STOP_TEST                    â€¢ STATUS                    â”‚ â”‚
â”‚  â”‚  â€¢ GET_STATUS                   â€¢ METRICS                   â”‚ â”‚
â”‚  â”‚  â€¢ UPDATE_LOAD                  â€¢ ERROR                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Results Aggregation & Storage                  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚  â”‚  Real-time   â”‚  â”‚  Historical  â”‚  â”‚  Export      â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  Aggregator  â”‚  â”‚  Storage     â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚  â€¢ Reports   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Stream    â”‚  â”‚  â€¢ Database  â”‚  â”‚  â€¢ CSV/JSON  â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Combine   â”‚  â”‚  â€¢ Time      â”‚  â”‚  â€¢ Grafana   â”‚    â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Display   â”‚  â”‚    Series    â”‚  â”‚              â”‚    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Designs

### Design 1: Centralized Orchestration (Recommended for Enterprise)

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Web UI / Dashboard    â”‚
                        â”‚   (User Interface)      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Configure Test
                                    â”‚ (10,000 TPS)
                                    â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚    ORCHESTRATOR         â”‚
                        â”‚                         â”‚
                        â”‚  â€¢ Load Distributor     â”‚
                        â”‚  â€¢ Worker Manager       â”‚
                        â”‚  â€¢ Result Aggregator    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   WORKER 1       â”‚  â”‚   WORKER 2      â”‚  â”‚   WORKER 3...5   â”‚
    â”‚                  â”‚  â”‚                 â”‚  â”‚                  â”‚
    â”‚   2,000 TPS      â”‚  â”‚   2,000 TPS     â”‚  â”‚   2,000 TPS each â”‚
    â”‚                  â”‚  â”‚                 â”‚  â”‚                  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ Task SDK   â”‚  â”‚  â”‚  â”‚ Task SDK   â”‚ â”‚  â”‚  â”‚ Task SDK   â”‚ â”‚
    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
    â”‚  â”‚ Metrics    â”‚  â”‚  â”‚  â”‚ Metrics    â”‚ â”‚  â”‚  â”‚ Metrics    â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                     â”‚                     â”‚
              â”‚                     â”‚                     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Metrics Backend       â”‚
                        â”‚                         â”‚
                        â”‚  â€¢ OpenTelemetry        â”‚
                        â”‚  â€¢ Time Series DB       â”‚
                        â”‚  â€¢ Grafana Dashboard    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Advantages:**
- âœ… Centralized control and monitoring
- âœ… Simplified coordination
- âœ… Easy load redistribution
- âœ… Historical test management
- âœ… User-friendly interface

**Disadvantages:**
- âŒ Single point of failure (orchestrator)
- âŒ Additional infrastructure component
- âŒ Network overhead for coordination

**Best For:**
- Enterprise environments
- Teams with multiple test scenarios
- Need for historical analysis
- Non-technical users

---

### Design 2: Peer-to-Peer Coordination (Cloud-Native)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Service Discovery                            â”‚
â”‚                 (Consul / etcd / K8s Service)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                     â”‚
       â”‚   Register/         â”‚   Heartbeat/        â”‚   Coordination
       â”‚   Discover          â”‚   Health            â”‚   Events
       â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   WORKER 1     â”‚â—„â”€â”€â”¤   WORKER 2     â”‚â—„â”€â”€â”¤   WORKER 3     â”‚
â”‚   (Leader)     â”‚â”€â”€â–ºâ”‚                â”‚â”€â”€â–ºâ”‚                â”‚
â”‚                â”‚   â”‚                â”‚   â”‚                â”‚
â”‚  â€¢ Gossip      â”‚   â”‚  â€¢ Sync        â”‚   â”‚  â€¢ Coordinate  â”‚
â”‚  â€¢ Election    â”‚   â”‚  â€¢ Share       â”‚   â”‚  â€¢ Execute     â”‚
â”‚  â€¢ Distribute  â”‚   â”‚    State       â”‚   â”‚                â”‚
â”‚                â”‚   â”‚                â”‚   â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Task SDK â”‚ â”‚   â”‚  â”‚ Task SDK â”‚  â”‚   â”‚  â”‚ Task SDK â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Shared Metrics Store    â”‚
              â”‚                          â”‚
              â”‚  â€¢ OpenTelemetry         â”‚
              â”‚  â€¢ Prometheus            â”‚
              â”‚  â€¢ Grafana               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Leader Election & Coordination Protocol             â”‚
â”‚                                                                 â”‚
â”‚  1. Workers discover each other via service registry          â”‚
â”‚  2. Leader election (Raft/Paxos/Bully algorithm)              â”‚
â”‚  3. Leader calculates load distribution                        â”‚
â”‚  4. Gossip protocol broadcasts configuration                   â”‚
â”‚  5. All workers execute in sync                                â”‚
â”‚  6. Metrics push to shared backend                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Advantages:**
- âœ… No single point of failure
- âœ… Auto-scaling friendly
- âœ… Cloud-native architecture
- âœ… Self-healing capabilities
- âœ… Kubernetes-ready

**Disadvantages:**
- âŒ Complex coordination logic
- âŒ Split-brain scenarios possible
- âŒ Requires service discovery infrastructure
- âŒ Debugging challenges

**Best For:**
- Cloud deployments
- Kubernetes environments
- Auto-scaling requirements
- DevOps teams

---

### Design 3: Standalone Mode (Simplest)

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        Command Line Interface        â”‚
    â”‚                                      â”‚
    â”‚  $ vajrapulse-worker run \               â”‚
    â”‚      --tps 5000 \                   â”‚
    â”‚      --duration 300s \              â”‚
    â”‚      --ramp-up 60s \                â”‚
    â”‚      --task my_test.py              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   STANDALONE WORKER   â”‚
           â”‚                       â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
           â”‚  â”‚  Task SDK       â”‚ â”‚
           â”‚  â”‚  â€¢ execute()    â”‚ â”‚
           â”‚  â”‚  â€¢ setup()      â”‚ â”‚
           â”‚  â”‚  â€¢ cleanup()    â”‚ â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
           â”‚           â”‚           â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
           â”‚  â”‚  Load Generator â”‚ â”‚
           â”‚  â”‚  â€¢ 5000 TPS     â”‚ â”‚
           â”‚  â”‚  â€¢ Ramp up      â”‚ â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
           â”‚           â”‚           â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
           â”‚  â”‚ Metrics Processorâ”‚ â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚           â”‚           â”‚
     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Console   â”‚ â”‚  OTLP   â”‚ â”‚BlazeMeterâ”‚
     â”‚ Output    â”‚ â”‚ Export  â”‚ â”‚  Export  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Advantages:**
- âœ… Extremely simple to use
- âœ… No infrastructure dependencies
- âœ… Quick testing and validation
- âœ… Easy CI/CD integration
- âœ… Low resource overhead

**Disadvantages:**
- âŒ Limited scale (single worker)
- âŒ No distributed coordination
- âŒ Manual aggregation for multi-worker

**Best For:**
- Development testing
- CI/CD pipelines
- Quick validations
- Small-scale tests

---

## Design Alternatives

### Alternative 1: Hybrid Architecture

Combines orchestrator with P2P fallback:

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ORCHESTRATOR    â”‚
                    â”‚  (Primary Mode)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚           â”‚           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Worker 1 â”‚  â”‚ Worker 2 â”‚  â”‚ Worker 3 â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚              â”‚             â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    P2P Gossip Protocol
                    (Fallback if orchestrator fails)
```

**Key Features:**
- Orchestrator manages when healthy
- Workers detect orchestrator failure
- Automatic P2P mode activation
- Seamless failover

---

### Alternative 2: Lambda/Serverless Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            API Gateway / Event Bridge           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚Lambda 1 â”‚ â”‚Lambda 2 â”‚ â”‚Lambda N â”‚  (Auto-scaled)
â”‚ Worker  â”‚ â”‚ Worker  â”‚ â”‚ Worker  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚           â”‚           â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  CloudWatch/X-Ray  â”‚
       â”‚  OpenTelemetry     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Benefits:**
- Infinite scalability
- Pay-per-use
- No infrastructure management

**Limitations:**
- Cold start latency
- Execution time limits
- Cost at high scale

---

### Alternative 3: Plugin-Based Modular Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VAJRA CORE                          â”‚
â”‚                   (Minimal Runtime)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚  Plugin Registry & Loader
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚       â”‚       â”‚           â”‚          â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Task   â”‚ â”‚Load â”‚ â”‚Metrics  â”‚ â”‚Coord   â”‚ â”‚Custom   â”‚
â”‚Pluginsâ”‚ â”‚Gen  â”‚ â”‚Exportersâ”‚ â”‚Plugins â”‚ â”‚Plugins  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Plugin Examples:
â€¢ HTTP Task Plugin
â€¢ gRPC Task Plugin  
â€¢ Kafka Task Plugin
â€¢ Database Task Plugin
â€¢ Custom Protocol Plugins
```

**Extensibility:**
- Load plugins dynamically
- Community contributions
- Domain-specific extensions
- Zero core changes needed

---

## Extensibility Points

### ğŸ”Œ 1. Task Interface Extensibility

```java
// Core Task Interface (Minimal)
public interface Task {
    void setup() throws Exception;
    TaskResult execute() throws Exception;
    void cleanup() throws Exception;
}

// Extended for HTTP (with virtual threads)
public abstract class HTTPTask implements Task {
    protected HttpClient httpClient;  // Java 21 HttpClient
    
    @Override
    public void setup() {
        httpClient = HttpClient.newBuilder()
            .executor(Executors.newVirtualThreadPerTaskExecutor())
            .build();
    }
    
    // Subclasses implement test logic
    protected abstract HttpRequest buildRequest();
    protected abstract TaskResult validateResponse(HttpResponse<?> response);
}

// Extended for Database
public abstract class DatabaseTask implements Task {
    protected DataSource dataSource;
    
    @Override
    public void setup() throws Exception {
        // Connection pool configured by user
        this.dataSource = createDataSource();
    }
    
    protected abstract DataSource createDataSource();
    protected abstract TaskResult executeQuery();
}

// CPU-Intensive Task (uses platform threads)
public abstract class CPUBoundTask implements Task {
    // Framework will execute on platform thread pool
    // when task is annotated with @CPUBound
    
    @Override
    public TaskResult execute() throws Exception {
        // Heavy computation, encryption, compression, etc.
        return performComputation();
    }
    
    protected abstract TaskResult performComputation();
}

// User controls test data generation completely
public class CustomAPITest implements Task {
    private Iterator<TestData> dataIterator;
    
    @Override
    public void setup() {
        // User's custom test data generation
        this.dataIterator = MyTestDataGenerator.create(
            "data.csv",  // from file
            MyDataFactory::generate,  // or factory
            // Framework doesn't interfere!
        );
    }
    
    @Override
    public TaskResult execute() {
        TestData data = dataIterator.next();  // User's control
        // Make request with data
        return result;
    }
}
```

**Extension Mechanism:**
- Interface-based design
- Inherit and override
- Add domain-specific methods
- Java 21 features (virtual threads, records, sealed types)
- User controls test data generation
- Framework only handles execution and metrics

---

### ğŸ”Œ 2. Metrics Exporter Extensibility

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          MetricsExporter Interface                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - export(metrics: MetricsBatch) -> void           â”‚
â”‚  - configure(config: Dict) -> void                  â”‚
â”‚  - flush() -> void                                  â”‚
â”‚  - close() -> void                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–³
                        â”‚ Implements
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OTLP Exporter  â”‚ â”‚BlazeMeter â”‚ â”‚CustomExporterâ”‚
â”‚                â”‚ â”‚ Exporter  â”‚ â”‚  (Plugin)    â”‚
â”‚ â€¢ OTLP Proto   â”‚ â”‚ â€¢ API     â”‚ â”‚ â€¢ Your Logic â”‚
â”‚ â€¢ gRPC/HTTP    â”‚ â”‚ â€¢ Cloud   â”‚ â”‚ â€¢ Any Backendâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Extension Points:**
- Standard interface
- Plugin registration system
- Configuration injection
- Async support

**Example Custom Exporter:**
```java
public class DatadogExporter implements MetricsExporter {
    private DatadogClient client;
    
    @Override
    public void configure(Map<String, Object> config) {
        String apiKey = (String) config.get("datadog_api_key");
        this.client = new DatadogClient(apiKey);
    }
    
    @Override
    public void export(MetricsBatch metrics) {
        // Send to Datadog API (async with virtual threads)
        Thread.startVirtualThread(() -> 
            client.send(metrics)
        );
    }
    
    @Override
    public void flush() {
        client.flush();
    }
}
```

---

### ğŸ”Œ 3. Load Distribution Strategy Extensibility

```
Strategy Pattern for Load Distribution:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LoadDistributionStrategy Interface  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  calculate(total_tps, workers)       â”‚
â”‚    -> Map<Worker, int>               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–³
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚          â”‚              â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Equal  â”‚ â”‚Weighted â”‚ â”‚ Capacity  â”‚ â”‚ Custom   â”‚
â”‚ Split  â”‚ â”‚ Round   â”‚ â”‚ Based     â”‚ â”‚ Strategy â”‚
â”‚        â”‚ â”‚ Robin   â”‚ â”‚           â”‚ â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Examples:**

1. **Equal Split** (Default)
   ```
   Total: 10,000 TPS
   Workers: 5
   Result: 2,000 TPS each
   ```

2. **Weighted Distribution**
   ```
   Worker 1 (weight: 2): 4,000 TPS
   Worker 2 (weight: 1): 2,000 TPS  
   Worker 3 (weight: 1): 2,000 TPS
   Worker 4 (weight: 1): 2,000 TPS
   ```

3. **Capacity-Based**
   ```
   Worker 1 (CPU: 80%): 1,500 TPS
   Worker 2 (CPU: 40%): 3,000 TPS
   Worker 3 (CPU: 60%): 2,000 TPS
   Worker 4 (CPU: 50%): 2,500 TPS
   ```

---

### ğŸ”Œ 4. Coordination Protocol Extensibility

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CoordinationProtocol Interface      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - register_worker()                   â”‚
â”‚  - discover_peers()                    â”‚
â”‚  - elect_leader()                      â”‚
â”‚  - broadcast_config()                  â”‚
â”‚  - synchronize_start()                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–³
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚          â”‚              â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gRPC    â”‚ â”‚ Gossip  â”‚ â”‚ Kafka     â”‚ â”‚ Custom   â”‚
â”‚ Protocolâ”‚ â”‚ Protocolâ”‚ â”‚ Streams   â”‚ â”‚ Protocol â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pluggable Coordination:**
- HTTP/REST for simplicity
- gRPC for performance
- Gossip for P2P
- Message queues for decoupling

---

### ğŸ”Œ 5. Scheduler Extensibility

```
Load Profile Types:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Scheduler Interface                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  generate_schedule(config) -> Schedule          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–³
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚             â”‚
  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Constant â”‚ â”‚ Ramp   â”‚ â”‚ Spike     â”‚ â”‚ Custom     â”‚
  â”‚  Load     â”‚ â”‚ Up/Downâ”‚ â”‚ Pattern   â”‚ â”‚ Schedule   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Examples:**

```
Constant Load:
TPS â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time

Ramp Up:
TPS â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚        /
    â”‚       /
    â”‚      /
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time

Spike Pattern:
TPS â”‚     â”Œâ”€â”      â”Œâ”€â”      â”Œâ”€â”
    â”‚     â”‚ â”‚      â”‚ â”‚      â”‚ â”‚
    â”‚â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â–º Time

Step Pattern:
TPS â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â”Œâ”€â”€â”€â”€â”¤        â”‚
    â”‚â”€â”€â”€â”€â”¤    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Time
```

---

### ğŸ”Œ 6. Storage Backend Extensibility

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ResultsStorage Interface          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - save_test_run(metadata)             â”‚
â”‚  - save_metrics(run_id, metrics)       â”‚
â”‚  - query_results(filters)              â”‚
â”‚  - get_historical_data(test_name)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–³
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚          â”‚              â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQLâ”‚ â”‚InfluxDB â”‚ â”‚ TimescaleDBâ”‚ â”‚S3/Blob  â”‚
â”‚          â”‚ â”‚         â”‚ â”‚            â”‚ â”‚Storage  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”Œ 7. Authentication & Security Extensibility

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AuthenticationProvider            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - authenticate(credentials)           â”‚
â”‚  - authorize(user, resource)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–³
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚          â”‚              â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API Key  â”‚ â”‚ OAuth2  â”‚ â”‚ mTLS       â”‚ â”‚ Custom  â”‚
â”‚          â”‚ â”‚ /OIDC   â”‚ â”‚ Certs      â”‚ â”‚ Auth    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Details

### Virtual Threads vs Platform Threads Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              THREAD STRATEGY SELECTION                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Task Type Classification:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ I/O-BOUND TASKS â†’ Virtual Threads                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ HTTP/REST API calls                                       â”‚
â”‚ â€¢ Database queries (JDBC with blocking I/O)                 â”‚
â”‚ â€¢ Message queue operations (Kafka, RabbitMQ)                â”‚
â”‚ â€¢ File I/O operations                                        â”‚
â”‚ â€¢ Network calls (gRPC, WebSocket)                           â”‚
â”‚                                                              â”‚
â”‚ Characteristics:                                             â”‚
â”‚ â€¢ Spend time waiting for I/O                                â”‚
â”‚ â€¢ Low CPU usage                                              â”‚
â”‚ â€¢ High concurrency (millions of virtual threads)            â”‚
â”‚                                                              â”‚
â”‚ Executor:                                                    â”‚
â”‚   Executors.newVirtualThreadPerTaskExecutor()               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CPU-BOUND TASKS â†’ Platform Threads                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Encryption/Decryption                                      â”‚
â”‚ â€¢ Compression/Decompression                                  â”‚
â”‚ â€¢ Complex calculations                                       â”‚
â”‚ â€¢ Image/Video processing                                     â”‚
â”‚ â€¢ Heavy JSON/XML parsing                                     â”‚
â”‚                                                              â”‚
â”‚ Characteristics:                                             â”‚
â”‚ â€¢ Continuous CPU usage                                       â”‚
â”‚ â€¢ No blocking I/O                                            â”‚
â”‚ â€¢ Limited concurrency (# of CPU cores)                      â”‚
â”‚                                                              â”‚
â”‚ Executor:                                                    â”‚
â”‚   new ThreadPoolExecutor(                                    â”‚
â”‚     Runtime.getRuntime().availableProcessors(),             â”‚
â”‚     ... ForkJoinPool.commonPool()                           â”‚
â”‚   )                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Configuration:

// Option 1: Annotation-based
@VirtualThreads  // Default
public class APILoadTest implements Task { ... }

@PlatformThreads  // For CPU-bound
public class EncryptionTest implements Task { ... }

// Option 2: Configuration-based
vajra:
  executor:
    type: VIRTUAL  # or PLATFORM
    
// Option 3: Auto-detection (future)
// Framework profiles task and switches executor automatically
```

### Java 21 Feature Utilization

```java
// 1. Virtual Threads (Project Loom)
var executor = Executors.newVirtualThreadPerTaskExecutor();
executor.submit(() -> task.execute());

// 2. Structured Concurrency (Preview)
try (var scope = new StructuredTaskScope.ShutdownOnFailure()) {
    Future<TaskResult> task1 = scope.fork(() -> task.execute());
    Future<TaskResult> task2 = scope.fork(() -> task.execute());
    
    scope.join();  // Wait for all
    scope.throwIfFailed();
}

// 3. Scoped Values (Preview) - Better than ThreadLocal
private static final ScopedValue<ExecutionContext> CONTEXT = 
    ScopedValue.newInstance();

ScopedValue.where(CONTEXT, executionContext)
    .run(() -> task.execute());

// 4. Records for Immutable Data
public record ExecutionMetrics(
    long startTime,
    long endTime,
    TaskResult result,
    Optional<Throwable> error
) {
    public Duration duration() {
        return Duration.ofNanos(endTime - startTime);
    }
}

// 5. Sealed Interfaces for TaskResult
public sealed interface TaskResult 
    permits Success, Failure {
    
    record Success(Object data) implements TaskResult {}
    record Failure(Throwable error) implements TaskResult {}
}

// 6. Pattern Matching for Switch
switch (taskResult) {
    case Success(var data) -> recordSuccess(data);
    case Failure(var error) -> recordFailure(error);
}
```

### Metrics Processor Deep Dive

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   METRICS PROCESSING PIPELINE                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Task.execute() returns TaskResult
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Task Executor  â”‚  â—„â”€â”€ Wraps every execute() call
â”‚  (Instrumented) â”‚
â”‚                 â”‚      Captures automatically:
â”‚  start = nanos()â”‚      â€¢ Start timestamp
â”‚  result = exec()â”‚      â€¢ End timestamp  
â”‚  end = nanos()  â”‚      â€¢ Latency (end - start)
â”‚                 â”‚      â€¢ Success/Failure
â”‚  Creates:       â”‚      â€¢ Exception details
â”‚  ExecutionMetricsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Raw Collector  â”‚  â—„â”€â”€ ExecutionMetrics (not TaskResult!)
â”‚  (Micrometer)   â”‚
â”‚                 â”‚      TaskResult only contains:
â”‚  â€¢ Timestamp    â”‚      â€¢ Success/Failure indicator
â”‚  â€¢ Latency      â”‚      â€¢ Optional result data
â”‚  â€¢ Success/Fail â”‚      â€¢ Optional error
â”‚  â€¢ Result Data  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Aggregator     â”‚  â—„â”€â”€ Window-based (1s, 5s, 1m)
â”‚                 â”‚
â”‚  â€¢ Count        â”‚      Per Window:
â”‚  â€¢ Sum          â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â€¢ Min/Max      â”‚      â”‚ TPS: 2,000       â”‚
â”‚  â€¢ Running Avg  â”‚      â”‚ P50: 45ms        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ P95: 120ms       â”‚
         â”‚               â”‚ P99: 250ms       â”‚
         â–¼               â”‚ Error%: 0.5%     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  Reservoir      â”‚
â”‚  Sampling       â”‚  â—„â”€â”€ Statistical sampling
â”‚                 â”‚      for percentiles
â”‚  â€¢ Histogram    â”‚
â”‚  â€¢ HDR         â”‚
â”‚  â€¢ T-Digest     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Formatter     â”‚  â—„â”€â”€ Convert to exporter format
â”‚                 â”‚
â”‚  â€¢ OTLP Proto   â”‚
â”‚  â€¢ JSON         â”‚
â”‚  â€¢ Custom       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Exporters     â”‚  â—„â”€â”€ Push to backends
â”‚                 â”‚
â”‚  â€¢ Batch        â”‚
â”‚  â€¢ Async        â”‚
â”‚  â€¢ Retry        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### OpenTelemetry Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  OPENTELEMETRY INTEGRATION                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Worker Process
    â”‚
    â”œâ”€â–º Traces
    â”‚   â”‚
    â”‚   â”œâ”€â–º Span: Test Execution
    â”‚   â”‚   â”œâ”€â–º Span: Task Setup
    â”‚   â”‚   â”œâ”€â–º Span: Task Execute (repeated)
    â”‚   â”‚   â””â”€â–º Span: Task Cleanup
    â”‚   â”‚
    â”‚   â””â”€â–º Context Propagation across workers
    â”‚
    â”œâ”€â–º Metrics
    â”‚   â”‚
    â”‚   â”œâ”€â–º Counter: total_requests
    â”‚   â”œâ”€â–º Counter: failed_requests
    â”‚   â”œâ”€â–º Histogram: request_latency
    â”‚   â”œâ”€â–º Gauge: active_virtual_users
    â”‚   â””â”€â–º Custom Metrics
    â”‚
    â””â”€â–º Logs (Structured)
        â”‚
        â”œâ”€â–º Error logs with trace correlation
        â””â”€â–º Debug logs

                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  OTLP Collector    â”‚
        â”‚                    â”‚
        â”‚  â€¢ Receive         â”‚
        â”‚  â€¢ Process         â”‚
        â”‚  â€¢ Export          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ Jaeger   â”‚ â”‚Prometheusâ”‚ â”‚ Grafana  â”‚
â”‚ (Traces) â”‚ â”‚(Metrics) â”‚ â”‚(Visualizeâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Benefits:**
- Distributed tracing across workers
- Correlation between metrics and traces
- Standard observability stack
- Vendor-neutral

---

### Grafana Dashboard Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              VAJRA TEST DASHBOARD - Grafana                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Test: API Load Test        Status: â— Running              â”‚
â”‚  Duration: 5m 23s          Workers: 5 Active               â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Throughput (TPS)   â”‚  â”‚  Response Time (ms)       â”‚   â”‚
â”‚  â”‚                     â”‚  â”‚                           â”‚   â”‚
â”‚  â”‚  10,000 â”¤   â•±â”€â”€â”€â”€â”€  â”‚  â”‚   500 â”¤                   â”‚   â”‚
â”‚  â”‚         â”‚  â•±        â”‚  â”‚       â”‚        â•±â”€â”€â•²       â”‚   â”‚
â”‚  â”‚   5,000 â”¤ â•±         â”‚  â”‚   250 â”¤   â•±â”€â”€â•±    â•²â”€â”€    â”‚   â”‚
â”‚  â”‚         â”‚â•±          â”‚  â”‚       â”‚  â•±             â•²  â”‚   â”‚
â”‚  â”‚       0 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚     0 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Latency Percentiles                                 â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  P50:  45ms  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                   â”‚ â”‚
â”‚  â”‚  P75:  78ms  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘                   â”‚ â”‚
â”‚  â”‚  P95: 156ms  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘                  â”‚ â”‚
â”‚  â”‚  P99: 289ms  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Success Rate       â”‚  â”‚  Error Distribution       â”‚   â”‚
â”‚  â”‚                     â”‚  â”‚                           â”‚   â”‚
â”‚  â”‚      99.5%          â”‚  â”‚  Timeout:    45%          â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”         â”‚  â”‚  5xx:        30%          â”‚   â”‚
â”‚  â”‚    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚         â”‚  â”‚  Connection: 25%          â”‚   â”‚
â”‚  â”‚    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ OK     â”‚  â”‚                           â”‚   â”‚
â”‚  â”‚    â”‚ â–ˆâ–ˆâ–ˆâ–‘â–‘ â”‚ Fail   â”‚  â”‚  [Pie Chart]              â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Worker Status                                       â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  Worker-1  â— Running   2,000 TPS   CPU: 65%  Mem:45% â”‚ â”‚
â”‚  â”‚  Worker-2  â— Running   2,000 TPS   CPU: 68%  Mem:42% â”‚ â”‚
â”‚  â”‚  Worker-3  â— Running   2,000 TPS   CPU: 71%  Mem:48% â”‚ â”‚
â”‚  â”‚  Worker-4  â— Running   2,000 TPS   CPU: 69%  Mem:44% â”‚ â”‚
â”‚  â”‚  Worker-5  â— Running   2,000 TPS   CPU: 67%  Mem:46% â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Scenarios

### Scenario 1: Kubernetes Deployment

```yaml
# Orchestrator Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: vajrapulse-orchestrator
spec:
  replicas: 2  # HA setup
  template:
    spec:
      containers:
      - name: orchestrator
        image: vajra/orchestrator:latest
        
---
# Worker Deployment (Auto-scaling)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: vajrapulse-worker
spec:
  replicas: 5  # Can be auto-scaled
  template:
    spec:
      containers:
      - name: worker
        image: vajra/worker:latest
        
---
# Horizontal Pod Autoscaler
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: vajrapulse-worker-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: vajrapulse-worker
  minReplicas: 5
  maxReplicas: 50
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
```

### Scenario 2: Docker Compose (Local Dev)

```yaml
version: '3.8'
services:
  orchestrator:
    image: vajra/orchestrator:latest
    ports:
      - "8080:8080"
    environment:
      - JAVA_TOOL_OPTIONS=-XX:+UseZGC -Xmx2g
      - WORKERS=worker-1,worker-2,worker-3
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
      
  worker-1:
    image: vajra/worker:latest
    environment:
      - JAVA_TOOL_OPTIONS=-XX:+UseZGC -Xmx4g
      - ORCHESTRATOR_URL=http://orchestrator:8080
      - WORKER_ID=worker-1
      - THREAD_STRATEGY=VIRTUAL  # for I/O-bound tasks
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 4G
      
  worker-2:
    image: vajra/worker:latest
    environment:
      - JAVA_TOOL_OPTIONS=-XX:+UseZGC -Xmx4g
      - ORCHESTRATOR_URL=http://orchestrator:8080
      - WORKER_ID=worker-2
      - THREAD_STRATEGY=VIRTUAL
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 4G
      
  worker-3:
    image: vajra/worker:latest
    environment:
      - JAVA_TOOL_OPTIONS=-XX:+UseG1GC -Xmx8g
      - ORCHESTRATOR_URL=http://orchestrator:8080
      - WORKER_ID=worker-3
      - THREAD_STRATEGY=PLATFORM  # for CPU-bound tasks
    deploy:
      resources:
        limits:
          cpus: '8'
          memory: 8G
      
  otel-collector:
    image: otel/opentelemetry-collector:latest
    
  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
```

**Note**: Virtual threads work best with ZGC or G1GC. For CPU-bound workloads on platform threads, configure appropriate heap and GC settings.

### Scenario 3: CI/CD Integration

```yaml
# GitHub Actions Example
name: Load Test
on: [push]

jobs:
  load-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Java 21
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '21'
          
      - name: Build Test Task
        run: |
          mvn clean package
          
      - name: Run VajraPulse Worker
        run: |
          java -jar vajrapulse-worker.jar run \
            --task-jar target/my-load-test.jar \
            --task-class com.example.MyAPITest \
            --tps 1000 \
            --duration 60s \
            --thread-strategy virtual \
            --exporter console
            
      - name: Check Results
        run: |
          if [ $FAILURE_RATE -gt 1 ]; then
            exit 1
          fi
```

---

## Summary of Extensibility

### ğŸ¯ Key Extensibility Dimensions

| Dimension | Extension Mechanism | Examples |
|-----------|-------------------|----------|
| **Tasks** | Abstract Base Class | HTTP, gRPC, Database, Kafka tasks |
| **Exporters** | Plugin Interface | Datadog, New Relic, custom backends |
| **Distribution** | Strategy Pattern | Equal, weighted, capacity-based |
| **Coordination** | Protocol Interface | gRPC, Gossip, REST, message queues |
| **Scheduling** | Scheduler Interface | Constant, ramp, spike, custom |
| **Storage** | Storage Interface | PostgreSQL, InfluxDB, S3 |
| **Auth** | Provider Interface | API key, OAuth, mTLS |

### ğŸš€ Design Highlights

1. **Multi-Mode Operation**: Orchestrated, P2P, Standalone
2. **Cloud-Native**: Kubernetes-ready, auto-scaling support
3. **Observable**: Deep OpenTelemetry integration
4. **Extensible**: Plugin architecture throughout
5. **Vendor-Neutral**: No lock-in to specific tools
6. **Developer-Friendly**: Simple SDK, clear interfaces
7. **Production-Ready**: HA, fault tolerance, monitoring

---

## Recommended Implementation Phases

### Phase 1: Core Foundation
- âœ… Task SDK with 3 methods (Java interface)
- âœ… Simplified TaskResult (Success/Failure only)
- âœ… Task Executor with automatic instrumentation
- âœ… Virtual thread execution engine
- âœ… Platform thread support for CPU-bound tasks
- âœ… Console exporter
- âœ… Standalone mode
- âœ… User-controlled test data generation

### Phase 2: Metrics & Observability
- âœ… Metrics processor with aggregation
- âœ… OpenTelemetry exporter
- âœ… BlazeMeter exporter
- âœ… Basic Grafana dashboard

### Phase 3: Distribution
- âœ… Orchestrator with load distribution
- âœ… Worker registration & discovery
- âœ… gRPC communication
- âœ… Web UI

### Phase 4: Advanced Features
- âœ… P2P coordination mode
- âœ… Auto-scaling support
- âœ… Historical data storage
- âœ… Advanced scheduling

### Phase 5: Extensibility
- âœ… Plugin system
- âœ… Custom exporter SDK
- âœ… Task libraries
- âœ… Community contributions

---

**This design provides a solid foundation for building VajraPulse with maximum flexibility and extensibility while maintaining simplicity where needed.**
